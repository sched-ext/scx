---
title: Re-enable COSMOS scheduler after API update
status: open
priority: 2
issue_type: task
created_at: 2026-02-20T02:46:24.245856445+00:00
updated_at: 2026-02-20T02:46:24.245856445+00:00
---

# Description

The COSMOS scheduler was disabled during the simulator.v2 rebase because the upstream API changed significantly:

1. start_readings map was removed - COSMOS now uses scx_pmu_read() kfunc instead
2. perf_enabled global was removed - now uses perf_config bitmask

To re-enable COSMOS:
1. Implement scx_pmu_read() kfunc stub in sim_bpf_stubs.c
2. Update wrapper.c to use perf_config instead of perf_enabled
3. Remove references to start_readings map and related code
4. Re-enable wrapper.c.disabled and cosmos.rs.disabled

Files to update:
- schedulers/cosmos/wrapper.c.disabled
- crates/scx_simulator/tests/cosmos.rs.disabled
