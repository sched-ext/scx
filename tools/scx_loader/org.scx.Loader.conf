<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">

<!--
  D-Bus configuration for scx_loader service

  SECURITY NOTICE:
  This configuration controls which users can communicate with the scx_loader
  D-Bus service on the system bus. The scx_loader service controls kernel
  schedulers, which is a privileged operation.

  CURRENT CONFIGURATION: Permissive (backward compatible)
  - Any local user can send messages to scx_loader
  - Authorization is enforced by scx_loader itself (see /etc/scx_loader.toml)
  - This allows flexibility in authorization methods (Polkit, group-based, etc.)

  SECURITY RECOMMENDATIONS:

  1. For production systems, configure authorization in /etc/scx_loader.toml:
     [security]
     authorization_mode = "group"  # or "polkit"
     required_group = "wheel"

  2. For additional defense-in-depth, you can restrict D-Bus access by group:

     <policy group="wheel">
       <allow send_destination="org.scx.Loader"/>
       <allow receive_sender="org.scx.Loader"/>
     </policy>

     Then remove or restrict the context="default" policy below.

  3. When using Polkit authorization mode, this D-Bus config can remain
     permissive - Polkit will handle fine-grained authorization checks.

  4. For maximum security, combine:
     - Group-based D-Bus access restriction (this file)
     - Polkit authorization (org.scx.Loader.policy)
     - Argument validation (/etc/scx_loader.toml: validate_arguments = true)

  Install location: /usr/share/dbus-1/system.d/org.scx.Loader.conf
-->

<busconfig>
    <!-- Allow root to own and communicate with the service -->
    <policy user="root">
        <allow own="org.scx.Loader"/>
        <allow send_destination="org.scx.Loader"/>
        <allow receive_sender="org.scx.Loader"/>
    </policy>

    <!--
      Default policy: Allow all local users to communicate with scx_loader.
      Authorization is enforced by scx_loader based on /etc/scx_loader.toml

      For stricter D-Bus-level access control, replace this with group-based
      policies as described in the security recommendations above.
    -->
    <policy context="default">
        <allow send_destination="org.scx.Loader"/>
        <allow receive_sender="org.scx.Loader"/>
    </policy>

    <!--
      EXAMPLE: Restrict D-Bus access to wheel group members
      Uncomment this and remove/restrict the context="default" policy above:

      <policy group="wheel">
        <allow send_destination="org.scx.Loader"/>
        <allow receive_sender="org.scx.Loader"/>
      </policy>
    -->
</busconfig>
